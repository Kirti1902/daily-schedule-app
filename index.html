<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Schedule Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1e293b;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .container {
            max-width: 768px;
            margin: auto;
        }
        .welcome-bg {
            background-image: radial-gradient(circle at top left, rgba(60, 150, 250, 0.1), transparent), radial-gradient(circle at bottom right, rgba(160, 80, 255, 0.1), transparent);
        }
        .welcome-card {
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(229, 231, 235, 0.4);
        }
        .animate-fade-in {
            animation: fadeIn 1s ease-in-out forwards;
        }
        .animate-slide-up {
            animation: slideUp 0.8s ease-out forwards;
        }
        .animate-pulse-scale {
            animation: pulseScale 2s infinite;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(2rem); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes pulseScale {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
        }

        /* Dark Mode Styles */
        body.dark {
            background-color: #1f2937;
            color: #f9fafb;
        }
        body.dark .container {
            background-color: #374151;
        }
        body.dark .welcome-card {
            background-color: rgba(55, 65, 81, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.4);
        }
        body.dark .welcome-bg {
            background-image: radial-gradient(circle at top left, rgba(60, 150, 250, 0.2), transparent), radial-gradient(circle at bottom right, rgba(160, 80, 255, 0.2), transparent);
        }
        body.dark section {
            background-color: #111827;
            border-color: #4b5563;
        }
        body.dark input, body.dark select {
            background-color: #4b5563;
            color: #f9fafb;
            border-color: #6b7280;
        }
        body.dark .text-gray-900 {
            color: #f9fafb;
        }
        body.dark .text-gray-500, body.dark .text-gray-600 {
            color: #d1d5db;
        }
        body.dark .bg-white {
            background-color: #4b5563;
        }
        body.dark .bg-gray-50 {
            background-color: #111827;
        }
        body.dark .bg-gray-300 {
            background-color: #4b5563;
            color: #d1d5db;
        }
        body.dark .bg-yellow-400 {
            background-color: #facc15;
        }
        body.dark .bg-yellow-500 {
            background-color: #eab308;
        }
        .line-through {
            text-decoration: line-through;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">
    <!-- Welcome Modal -->
    <div id="welcome-modal" class="fixed inset-0 welcome-bg flex items-center justify-center p-4 z-40 transition-opacity duration-500">
        <div class="welcome-card max-w-lg w-full text-center space-y-6 rounded-2xl p-8 shadow-2xl">
            <h2 class="text-4xl sm:text-5xl font-extrabold text-gray-800 animate-fade-in" style="animation-delay: 0.3s;">
                Welcome!
            </h2>
            <p class="text-gray-600 text-lg animate-fade-in" style="animation-delay: 0.5s;">
                This simple app helps you track your daily schedule and stay on top of your tasks.
            </p>
            <ul class="text-left text-gray-500 space-y-3 max-w-sm mx-auto">
                <li class="flex items-center space-x-3 animate-slide-up" style="animation-delay: 0.7s;">
                    <i class="fas fa-list-check text-blue-500"></i>
                    <span>Track and manage daily activities</span>
                </li>
                <li class="flex items-center space-x-3 animate-slide-up" style="animation-delay: 0.9s;">
                    <i class="fas fa-chart-line text-blue-500"></i>
                    <span>Visualize your progress with charts</span>
                </li>
            </ul>
            <button id="get-started-btn" class="bg-blue-500 hover:bg-blue-600 text-white text-lg font-bold py-3 px-6 rounded-lg transition-colors mt-6 animate-pulse-scale">
                Get Started
            </button>
        </div>
    </div>

    <!-- Main Application Container -->
    <div id="main-app" class="container bg-white rounded-3xl shadow-xl p-6 md:p-8 space-y-6 hidden">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-3xl sm:text-4xl font-bold text-center flex-1">Daily To-Do List</h1>
            <button id="theme-toggle" class="p-3 rounded-full text-gray-600 hover:text-blue-500 transition-colors">
                <i class="fas fa-moon text-xl"></i>
            </button>
        </div>

        <!-- Activity Section -->
        <section class="bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200">
            <h2 class="text-2xl font-semibold mb-4">Activities</h2>
            <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4 mb-4">
                <input type="text" id="activity-name" placeholder="Activity Name" class="w-full flex-1 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="number" id="scheduled-hours" placeholder="Hours" class="w-full sm:w-28 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="number" id="scheduled-minutes" placeholder="Minutes" class="w-full sm:w-28 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="date" id="activity-date" class="w-full sm:w-40 p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button id="add-activity-btn" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white font-bold p-3 rounded-xl transition-colors">
                    Add
                </button>
            </div>
            <div id="validation-message" class="text-red-500 text-sm mt-2 hidden"></div>
            <ul id="activity-list" class="space-y-3"></ul>
        </section>

        <!-- Charts Section -->
        <section class="bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200">
            <h2 class="text-2xl font-semibold mb-4">My Progress</h2>
            <div class="flex justify-center space-x-4 mb-4">
                <button id="monthly-view-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-xl transition-colors">
                    Monthly View
                </button>
                <button id="yearly-view-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-xl transition-colors">
                    Yearly View
                </button>
            </div>
            <div id="chart-container" class="relative">
                <canvas id="progress-chart"></canvas>
            </div>
        </section>
    </div>

    <script type="module">
        let activities = [];
        let progressChart;
        let currentView = 'monthly';

        // UI elements
        const activityList = document.getElementById('activity-list');
        const activityNameInput = document.getElementById('activity-name');
        const scheduledHoursInput = document.getElementById('scheduled-hours');
        const scheduledMinutesInput = document.getElementById('scheduled-minutes');
        const activityDateInput = document.getElementById('activity-date');
        const addActivityBtn = document.getElementById('add-activity-btn');
        const validationMessage = document.getElementById('validation-message');
        const progressChartCanvas = document.getElementById('progress-chart');
        const monthlyViewBtn = document.getElementById('monthly-view-btn');
        const yearlyViewBtn = document.getElementById('yearly-view-btn');
        
        // Welcome modal logic
        const getStartedBtn = document.getElementById('get-started-btn');
        const welcomeModal = document.getElementById('welcome-modal');
        const mainApp = document.getElementById('main-app');

        const hasVisited = localStorage.getItem('hasVisited');
        if (hasVisited) {
            welcomeModal.style.display = 'none';
            mainApp.classList.remove('hidden');
        } else {
            welcomeModal.style.display = 'flex';
            mainApp.classList.add('hidden');
        }

        getStartedBtn.addEventListener('click', () => {
            welcomeModal.style.display = 'none';
            mainApp.classList.remove('hidden');
            localStorage.setItem('hasVisited', 'true');
        });

        // Theme Switcher Logic
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeIcon = themeToggleBtn.querySelector('i');
        const userPrefersDark = localStorage.getItem('theme') === 'dark' ||
                                (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);

        if (userPrefersDark) {
            document.body.classList.add('dark');
            themeIcon.classList.replace('fa-moon', 'fa-sun');
        }

        themeToggleBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark');
            if (document.body.classList.contains('dark')) {
                localStorage.setItem('theme', 'dark');
                themeIcon.classList.replace('fa-moon', 'fa-sun');
            } else {
                localStorage.setItem('theme', 'light');
                themeIcon.classList.replace('fa-sun', 'fa-moon');
            }
            renderChart(currentView);
        });

        // --- Data Persistence with localStorage ---
        function saveActivities() {
            localStorage.setItem('activities', JSON.stringify(activities));
        }

        function loadActivities() {
            const storedActivities = localStorage.getItem('activities');
            if (storedActivities) {
                activities = JSON.parse(storedActivities);
            }
        }
        
        function generateId() {
            return Math.random().toString(36).substr(2, 9);
        }

        function formatDuration(totalMinutes) {
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            let durationString = '';
            if (hours > 0) {
                durationString += `${hours} hr`;
            }
            if (minutes > 0) {
                if (hours > 0) durationString += ' ';
                durationString += `${minutes} min`;
            }
            if (totalMinutes === 0) {
                return '0 min';
            }
            return durationString;
        }

        function renderActivities() {
            activityList.innerHTML = '';
            if (activities.length === 0) {
                activityList.innerHTML = `<p class="text-center text-gray-500 dark:text-gray-400">No activities scheduled yet.</p>`;
                return;
            }

            activities.forEach((activity) => {
                const li = document.createElement('li');
                li.classList.add('flex', 'flex-col', 'sm:flex-row', 'items-start', 'sm:items-center', 'justify-between', 'bg-white', 'p-4', 'rounded-xl', 'shadow-sm', 'border', 'border-gray-200', 'dark:bg-gray-700', 'dark:border-gray-600');
                
                const taskClass = activity.isCompleted ? 'line-through text-gray-400 dark:text-gray-500' : 'text-gray-900 dark:text-gray-100';
                const icon = activity.isCompleted ? '<i class="fas fa-check-circle text-green-500 mr-2"></i>' : '';
                
                const buttonText = activity.isCompleted ? 'Mark Incomplete' : 'Mark Complete';
                const buttonClass = activity.isCompleted ? 'bg-yellow-500 hover:bg-yellow-600' : 'bg-green-500 hover:bg-green-600';

                li.innerHTML = `
                    <div class="flex-1 flex flex-col sm:flex-row items-start sm:items-center space-y-1 sm:space-y-0 sm:space-x-4">
                        <span class="text-lg font-medium ${taskClass}">${icon}${activity.name}</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400"><i class="fas fa-calendar-alt mr-1"></i> ${activity.date}</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400"><i class="fas fa-clock mr-1"></i> ${formatDuration(activity.totalMinutes)}</span>
                    </div>
                    <div class="flex space-x-2 mt-2 sm:mt-0">
                        <button data-id="${activity.id}" class="update-btn ${buttonClass} text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm">${buttonText}</button>
                        <button data-id="${activity.id}" class="delete-btn bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm">Delete</button>
                    </div>
                `;
                
                activityList.appendChild(li);
            });
        }

        addActivityBtn.addEventListener('click', () => {
            const name = activityNameInput.value.trim();
            const hours = parseInt(scheduledHoursInput.value) || 0;
            const minutes = parseInt(scheduledMinutesInput.value) || 0;
            const date = activityDateInput.value;

            if (!name || !date || (hours === 0 && minutes === 0)) {
                validationMessage.textContent = 'Please fill out all fields and provide a duration.';
                validationMessage.classList.remove('hidden');
                return;
            }
            
            validationMessage.classList.add('hidden');
            
            const totalMinutes = (hours * 60) + minutes;
            const newActivity = {
                id: generateId(),
                name: name,
                totalMinutes: totalMinutes,
                date: date,
                isCompleted: false
            };
            activities.push(newActivity);
            saveActivities();
            renderActivities();
            renderChart(currentView);

            activityNameInput.value = '';
            scheduledHoursInput.value = '';
            scheduledMinutesInput.value = '';
            activityDateInput.value = '';
        });

        activityList.addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (!button) return;
            const id = button.dataset.id;
            
            if (button.classList.contains('delete-btn')) {
                activities = activities.filter(a => a.id !== id);
            } else if (button.classList.contains('update-btn')) {
                const activity = activities.find(a => a.id === id);
                if (activity) {
                    activity.isCompleted = !activity.isCompleted;
                }
            }
            saveActivities();
            renderActivities();
            renderChart(currentView);
        });

        // Chart Logic
        function getChartData(view) {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            let labels, totalTimeData, completedTimeData;

            if (view === 'monthly') {
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                labels = Array.from({ length: daysInMonth }, (_, i) => i + 1);
                totalTimeData = labels.map(day => {
                    const dateString = `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                    return activities
                        .filter(a => a.date === dateString)
                        .reduce((sum, a) => sum + a.totalMinutes, 0);
                });
                completedTimeData = labels.map(day => {
                    const dateString = `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                    return activities
                        .filter(a => a.date === dateString && a.isCompleted)
                        .reduce((sum, a) => sum + a.totalMinutes, 0);
                });
            } else if (view === 'yearly') {
                labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                totalTimeData = labels.map((_, monthIndex) => {
                    return activities
                        .filter(a => {
                            const date = new Date(a.date);
                            return date.getMonth() === monthIndex && date.getFullYear() === currentYear;
                        })
                        .reduce((sum, a) => sum + a.totalMinutes, 0);
                });
                completedTimeData = labels.map((_, monthIndex) => {
                    return activities
                        .filter(a => {
                            const date = new Date(a.date);
                            return date.getMonth() === monthIndex && date.getFullYear() === currentYear && a.isCompleted;
                        })
                        .reduce((sum, a) => sum + a.totalMinutes, 0);
                });
            }
            return { labels, totalTimeData, completedTimeData };
        }

        function renderChart(view) {
            const { labels, totalTimeData, completedTimeData } = getChartData(view);
            const isDarkMode = document.body.classList.contains('dark');

            if (progressChart) {
                progressChart.destroy();
            }

            progressChart = new Chart(progressChartCanvas, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Total Scheduled Time (min)',
                            data: totalTimeData,
                            backgroundColor: 'rgba(59, 130, 246, 0.7)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1,
                            borderRadius: 10,
                        },
                        {
                            label: 'Completed Time (min)',
                            data: completedTimeData,
                            backgroundColor: 'rgba(16, 185, 129, 0.7)',
                            borderColor: 'rgba(16, 185, 129, 1)',
                            borderWidth: 1,
                            borderRadius: 10,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: isDarkMode ? '#d1d5db' : '#1e293b'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: isDarkMode ? '#d1d5db' : '#1e293b'
                            }
                        },
                        y: {
                            stacked: false,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Total Minutes',
                                color: isDarkMode ? '#d1d5db' : '#1e293b'
                            },
                            ticks: {
                                color: isDarkMode ? '#d1d5db' : '#1e293b'
                            }
                        }
                    }
                }
            });
        }

        monthlyViewBtn.addEventListener('click', () => {
            currentView = 'monthly';
            monthlyViewBtn.classList.replace('bg-gray-300', 'bg-blue-500');
            monthlyViewBtn.classList.replace('text-gray-800', 'text-white');
            yearlyViewBtn.classList.replace('bg-blue-500', 'bg-gray-300');
            yearlyViewBtn.classList.replace('text-white', 'text-gray-800');
            renderChart(currentView);
        });

        yearlyViewBtn.addEventListener('click', () => {
            currentView = 'yearly';
            yearlyViewBtn.classList.replace('bg-gray-300', 'bg-blue-500');
            yearlyViewBtn.classList.replace('text-gray-800', 'text-white');
            monthlyViewBtn.classList.replace('bg-blue-500', 'bg-gray-300');
            monthlyViewBtn.classList.replace('text-white', 'text-gray-800');
            renderChart(currentView);
        });

        // Initialize on page load
        loadActivities();
        renderActivities();
        renderChart(currentView);
    </script>
</body>
</html>
